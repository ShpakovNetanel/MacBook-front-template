import { Dialog as BaseDialog } from "@base-ui-components/react";
import clsx from "clsx";
import { Menu } from "lucide-react";
import type { PropsWithChildren, ReactNode } from "react";
import styles from "./Drawer.module.scss";

type Direction = "left" | "right" | "top" | "bottom";
const XAxios = ['left', 'right'];
const YAxios = ['top', 'bottom'];

type Classes = {
    Trigger?: keyof typeof styles;
    Drawer?: keyof typeof styles;
    Icon?: keyof typeof styles;
}

type SlotProps = {
    height?: string;
    width?: string;
    direction?: Direction;
    disableBackdrop?: boolean;
    classes?: Classes;
}

type DrawerProps = {
    triggerIcon?: ReactNode;
    slotProps?: SlotProps;
} & PropsWithChildren
    & BaseDialog.Root.Props;

export const Drawer = ({
    children,
    triggerIcon,
    slotProps,
    ...props
}: DrawerProps) => {
    const direction = slotProps?.direction ?? 'right';

    const width: string = slotProps?.width ?
        slotProps.width :
        XAxios.includes(direction) ?
            '30vw' :
            '100%';

    const height: string = slotProps?.height ?
        slotProps.height :
        YAxios.includes(direction) ?
            '25vh' :
            '100%';

    return (
        <BaseDialog.Root {...props}>
            <BaseDialog.Trigger className={clsx(styles.Trigger, slotProps?.classes?.Trigger)}>
                {triggerIcon ?? <Menu className={clsx(slotProps?.classes?.Icon)}/>}
            </BaseDialog.Trigger>
            <BaseDialog.Portal>
                {!slotProps?.disableBackdrop && <BaseDialog.Backdrop
                    className={styles.Backdrop} />}
                <BaseDialog.Popup className={clsx(styles.Drawer, slotProps?.classes?.Drawer, styles[direction])}
                    style={{ width, height }}>
                    {children}
                </BaseDialog.Popup>
            </BaseDialog.Portal>
        </BaseDialog.Root>
    );
};
